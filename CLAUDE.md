# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã¯ã€è«–æ–‡ã€ŒSIMCITY: MULTI-AGENT URBAN DEVELOPMENT SIMULATION WITH RICH INTERACTIONSã€ã®å®Ÿè£…ã‚’ç›®æŒ‡ã™ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚LLMã‚’æ´»ç”¨ã—ãŸãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçµŒæ¸ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã€ä¸–å¸¯ã€ä¼æ¥­ã€ä¸­å¤®éŠ€è¡Œã€æ”¿åºœã®4ã¤ã®ä¸»è¦ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç›¸äº’ä½œç”¨ã—ã€ãƒã‚¯ãƒ­çµŒæ¸ˆç¾è±¡ã‚’å†ç¾ã—ã¾ã™ã€‚

## ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³ï¼ˆ2025-10-14ï¼‰

**ğŸ‰ å…¨Phaseå®Œäº†ï¼166/166ã‚¿ã‚¹ã‚¯ (100%) âœ…**
**ã‚³ãƒ¼ãƒ‰å“è³ª: ruff All checks passed âœ…**

### å®Œäº†æ¸ˆã¿ãƒ•ã‚§ãƒ¼ã‚º

**Phase 0: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆå®Œäº†ï¼‰**
- uv + ruffç’°å¢ƒæ§‹ç¯‰å®Œäº†
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ•´å‚™ï¼ˆsimulation_config.yaml, llm_config.yamlï¼‰
- Apache 2.0ãƒ©ã‚¤ã‚»ãƒ³ã‚¹è¨­å®š
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆï¼ˆREADME.md, CLAUDE.md, TASKS.mdï¼‰

**Phase 1: ã‚³ã‚¢åŸºç›¤å®Ÿè£…ï¼ˆå®Œäº†ï¼‰**
- LLMçµ±åˆï¼ˆ`src/llm/llm_interface.py` 263è¡Œï¼‰
  - OpenAI APIçµ±åˆ
  - Function Callingå®Ÿè£…
  - ã‚³ã‚¹ãƒˆè¿½è·¡
  - ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆ`src/llm/prompts/` 4ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼ˆ`src/models/data_models.py` 361è¡Œï¼‰
- çµŒæ¸ˆãƒ¢ãƒ‡ãƒ«ï¼ˆ`src/models/economic_models.py` 471è¡Œï¼‰
  - Cobb-Douglasç”Ÿç”£é–¢æ•°
  - TaxationSystem
  - TaylorRule
  - MacroeconomicIndicators
- ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ã‚¸ãƒ³éª¨æ ¼ï¼ˆ`src/environment/simulation.py` 355è¡Œï¼‰
- BaseAgentï¼ˆ`src/agents/base_agent.py` 283è¡Œï¼‰
- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆ`src/utils/` 399è¡Œï¼‰

**Phase 2: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè£…ï¼ˆå®Œäº†ï¼‰**
- HouseholdAgentï¼ˆ`src/agents/household.py` 501è¡Œï¼‰
  - Lognormalåˆ†å¸ƒãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
  - 5ã¤ã®æ„æ€æ±ºå®šé–¢æ•°
  - 58ã‚¹ã‚­ãƒ«å¯¾å¿œ
- FirmAgentï¼ˆ`src/agents/firm.py` 395è¡Œï¼‰
  - 44ä¼æ¥­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¯¾å¿œ
  - Cobb-Douglasç”Ÿç”£é–¢æ•°çµ±åˆ
  - ç ´ç”£åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯
- GovernmentAgentï¼ˆ`src/agents/government.py` 301è¡Œï¼‰
  - ç´¯é€²èª²ç¨ã‚·ã‚¹ãƒ†ãƒ 
  - UBIé…å¸ƒ
  - å¤±æ¥­çµ¦ä»˜
- CentralBankAgentï¼ˆ`src/agents/central_bank.py` 287è¡Œï¼‰
  - Taylor ruleå®Ÿè£…
  - é‡‘åˆ©å¹³æ»‘åŒ–ï¼ˆÏ=0.8ï¼‰
- ãƒ†ã‚¹ãƒˆ: 41/41æˆåŠŸ

**Phase 3: å¸‚å ´ãƒ¡ã‚«ãƒ‹ã‚ºãƒ å®Ÿè£…ï¼ˆå®Œäº†ï¼‰**
- LaborMarketï¼ˆ`src/environment/markets/labor_market.py` 297è¡Œï¼‰
  - ç¢ºç‡çš„ãƒãƒƒãƒãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
  - ã‚¹ã‚­ãƒ«ãƒ™ãƒ¼ã‚¹åŠ¹ç‡è¨ˆç®—
  - è·é›¢è€ƒæ…®ã‚ªãƒ—ã‚·ãƒ§ãƒ³
- GoodsMarketï¼ˆ`src/environment/markets/goods_market.py` 261è¡Œï¼‰
  - 44è²¡ã®å–å¼•ãƒ¡ã‚«ãƒ‹ã‚ºãƒ 
  - ä¾¡æ ¼ãƒ™ãƒ¼ã‚¹ãƒãƒƒãƒãƒ³ã‚°
  - éœ€çµ¦ãƒŸã‚¹ãƒãƒƒãƒè¿½è·¡
- FinancialMarketï¼ˆ`src/environment/markets/financial_market.py` 179è¡Œï¼‰
  - é é‡‘ãƒ»è²¸å‡ºã‚·ã‚¹ãƒ†ãƒ 
  - æ”¿ç­–é‡‘åˆ©+ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ–¹å¼
  - é è²¸ç‡è¿½è·¡
- ãƒ†ã‚¹ãƒˆ: 17/17æˆåŠŸ

**Phase 4: åœ°ç†ãƒ»å¯è¦–åŒ–å®Ÿè£…ï¼ˆå®Œäº†ï¼‰**
- åœ°ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ`src/environment/geography.py` 332è¡Œï¼‰
  - 100Ã—100ã‚°ãƒªãƒƒãƒ‰ãƒ™ãƒ¼ã‚¹éƒ½å¸‚ãƒãƒƒãƒ—
  - å»ºç‰©ç®¡ç†ï¼ˆè¿½åŠ ã€å‰Šé™¤ã€æ¤œç´¢ï¼‰
  - è·é›¢è¨ˆç®—ï¼ˆãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã€ãƒãƒ³ãƒãƒƒã‚¿ãƒ³ï¼‰
- ãƒãƒƒãƒ—å¯è¦–åŒ–ï¼ˆ`src/visualization/map_generator.py` 348è¡Œï¼‰
  - å»ºç‰©ã‚¿ã‚¤ãƒ—ãƒãƒƒãƒ—
  - å æœ‰ç‡ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—
  - å¯†åº¦ãƒãƒƒãƒ—
  - è¤‡åˆãƒ“ãƒ¥ãƒ¼
- çµŒæ¸ˆã‚°ãƒ©ãƒ•ï¼ˆ`src/visualization/plots.py` 561è¡Œï¼‰
  - ãƒ•ã‚£ãƒªãƒƒãƒ—ã‚¹æ›²ç·š
  - ã‚ªãƒ¼ã‚¯ãƒ³ã®æ³•å‰‡
  - ãƒ™ãƒãƒªãƒƒã‚¸æ›²ç·š
  - ã‚¨ãƒ³ã‚²ãƒ«ã®æ³•å‰‡
  - ä¾¡æ ¼å¼¾åŠ›æ€§åˆ†æ
  - åˆ†å¸ƒãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ 
- Streamlitãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆ`src/visualization/dashboard.py` 573è¡Œï¼‰
  - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–Web UI
  - 4ã¤ã®ã‚¿ãƒ–ï¼ˆOverview, City Map, Economic Indicators, Analysisï¼‰
  - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¯è¦–åŒ–
- ãƒ†ã‚¹ãƒˆ: 58/58æˆåŠŸ

**Phase 5: ãƒ‡ãƒ¼ã‚¿æº–å‚™ï¼ˆå®Œäº† 8/8ï¼‰** âœ…
- ã‚¹ã‚­ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆ`src/data/skill_types.py` 410è¡Œï¼‰
  - 58ç¨®é¡ã®ã‚¹ã‚­ãƒ«å®šç¾©
  - 10ã‚«ãƒ†ã‚´ãƒª
  - è³ƒé‡‘ä¹—æ•°è¨ˆç®—
- è²¡ãƒ‡ãƒ¼ã‚¿ï¼ˆ`src/data/goods_types.py` 342è¡Œï¼‰
  - 44ç¨®é¡ã®è²¡å®šç¾©
  - 10ã‚«ãƒ†ã‚´ãƒª
  - å¿…éœ€å“22ã€å¥¢ä¾ˆå“22
- ä¼æ¥­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆ`data/firm_templates/` 44ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
  - 44ä¼æ¥­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆJSONå½¢å¼ï¼‰
- ä¸–å¸¯ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ï¼ˆ`src/agents/household.py`ï¼‰
  - Lognormalæ‰€å¾—åˆ†å¸ƒ
  - ã‚¹ã‚­ãƒ«ãƒ»å¹´é½¢ãƒ»æ•™è‚²ãƒ¬ãƒ™ãƒ«ç”Ÿæˆ
- åˆæœŸãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆ`scripts/generate_initial_households.py` 155è¡Œï¼‰
  - 200ä¸–å¸¯ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆç”Ÿæˆ
  - data/initial_households.json (224.8 KB)
- ãƒ†ã‚¹ãƒˆ: 14/14æˆåŠŸ âœ…

**Phase 6: çµ±åˆãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼ï¼ˆå®Œäº† 15/15ï¼‰** âœ…
- **Phase 6.1 å˜ä½“ãƒ†ã‚¹ãƒˆè£œå®Œ**: âœ… å®Œäº†ï¼ˆ`tests/test_performance.py` 104è¡Œï¼‰
  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆ6ãƒ†ã‚¹ãƒˆï¼‰
  - ã‚«ãƒãƒ¬ãƒƒã‚¸: 86%é”æˆï¼ˆç›®æ¨™80%è¶…éï¼‰
- **Phase 6.2 çµ±åˆãƒ†ã‚¹ãƒˆ**: âœ… å®Œäº†ï¼ˆ`tests/test_integration.py` 585è¡Œï¼‰
  - å¸‚å ´ãƒ¡ã‚«ãƒ‹ã‚ºãƒ çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆ5ãƒ†ã‚¹ãƒˆï¼‰
  - ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œãƒ†ã‚¹ãƒˆï¼ˆ5ãƒ†ã‚¹ãƒˆï¼‰
  - çŠ¶æ…‹ä¿å­˜/å¾©å…ƒãƒ†ã‚¹ãƒˆï¼ˆ4ãƒ†ã‚¹ãƒˆï¼‰
  - åœ°ç†ã‚·ã‚¹ãƒ†ãƒ çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆ2ãƒ†ã‚¹ãƒˆï¼‰
  - ãƒ†ã‚¹ãƒˆçµæœ: 15/15æˆåŠŸ âœ…
- **Phase 6.3 çµŒæ¸ˆç¾è±¡æ¤œè¨¼**: âœ… å®Œäº†ï¼ˆ`experiments/validation.py` 560è¡Œï¼‰
  - 7ã¤ã®çµŒæ¸ˆç¾è±¡æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ12ãƒ†ã‚¹ãƒˆï¼‰
  - Phillips Curveã€Okun's Lawã€Beveridge Curve
  - Price Elasticityã€Engel's Law
  - Investment Volatilityã€Price Stickiness
  - ãƒ†ã‚¹ãƒˆçµæœ: 12/12æˆåŠŸ âœ…
- **Phase 6.4 ãƒ­ãƒã‚¹ãƒˆãƒã‚¹ãƒ†ã‚¹ãƒˆ**: âœ… å®Œäº†ï¼ˆ`experiments/robustness_test.py` 440è¡Œï¼‰
  - å®šæ€§çš„ä¸€è‡´æ¤œè¨¼ï¼ˆ7ã¤ã®çµŒæ¸ˆç¾è±¡ï¼‰
  - çµ±è¨ˆçš„æœ‰æ„æ€§æ¤œè¨¼ï¼ˆå¤‰å‹•ä¿‚æ•°ã«ã‚ˆã‚‹å®‰å®šæ€§è©•ä¾¡ï¼‰
  - ãƒˆãƒ¬ãƒ³ãƒ‰ä¸€è‡´æ€§æ¤œè¨¼ï¼ˆæ™‚ç³»åˆ—ç›¸é–¢åˆ†æï¼‰
  - ãƒ†ã‚¹ãƒˆçµæœ: 6/6æˆåŠŸ âœ…

### ãƒ†ã‚¹ãƒˆçµæœ

```
å…¨207ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ: 207/207æˆåŠŸ (100%)
- test_economic_models.py: 18ãƒ†ã‚¹ãƒˆ (Phase 1)
- test_llm_integration.py: 2ãƒ†ã‚¹ãƒˆ (Phase 1)
- test_household_agent.py: 14ãƒ†ã‚¹ãƒˆ (Phase 2)
- test_phase2_agents.py: 27ãƒ†ã‚¹ãƒˆ (Phase 2)
- test_labor_market.py: 8ãƒ†ã‚¹ãƒˆ (Phase 3)
- test_goods_market.py: 4ãƒ†ã‚¹ãƒˆ (Phase 3)
- test_financial_market.py: 5ãƒ†ã‚¹ãƒˆ (Phase 3)
- test_geography.py: 20ãƒ†ã‚¹ãƒˆ (Phase 4)
- test_map_generator.py: 14ãƒ†ã‚¹ãƒˆ (Phase 4)
- test_plots.py: 20ãƒ†ã‚¹ãƒˆ (Phase 4)
- test_dashboard.py: 4ãƒ†ã‚¹ãƒˆ (Phase 4)
- test_phase5_data.py: 14ãƒ†ã‚¹ãƒˆ (Phase 5)
- test_integration.py: 15ãƒ†ã‚¹ãƒˆ (Phase 6.2)
- test_validation.py: 12ãƒ†ã‚¹ãƒˆ (Phase 6.3)
- test_robustness.py: 6ãƒ†ã‚¹ãƒˆ (Phase 6.4)
- test_performance.py: 6ãƒ†ã‚¹ãƒˆ (Phase 6.1)
- test_phase9_integration.py: 18ãƒ†ã‚¹ãƒˆ (Phase 9)

ã‚«ãƒãƒ¬ãƒƒã‚¸: 86%ï¼ˆç›®æ¨™80%é”æˆï¼‰
ã‚³ãƒ¼ãƒ‰å“è³ª: ruff All checks passed âœ…
```

**Phase 7: å®Ÿé¨“ãƒ»æœ€é©åŒ–ï¼ˆå®Œäº† 11/11ï¼‰** âœ…
- **Phase 7.1 ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ**: âœ… å®Œäº†ï¼ˆ`scripts/run_baseline.py` 403è¡Œï¼‰
  - 180ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
  - ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°å¯¾å¿œã€ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆä¿å­˜ã€è‡ªå‹•æ¤œè¨¼ãƒ»å¯è¦–åŒ–
- **Phase 7.2 å¤–ç”Ÿã‚·ãƒ§ãƒƒã‚¯å®Ÿé¨“**: âœ… å®Œäº†ï¼ˆ`scripts/run_shock_experiments.py` 507è¡Œï¼‰
  - ä¾¡æ ¼/æ”¿ç­–/äººå£ã‚·ãƒ§ãƒƒã‚¯å®Ÿé¨“ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
  - ã‚·ãƒ§ãƒƒã‚¯å‰å¾Œã®å½±éŸ¿åˆ†æã€è‡ªå‹•å¯è¦–åŒ–
- **Phase 7.3 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: âœ… Phase 7.3.1å®Œäº†ã€Phase 7.3.2-7.3.4æ–‡æ›¸åŒ–å®Œäº†
  - LLMå‘¼ã³å‡ºã—å‰Šæ¸›ï¼ˆæ±ºå®šé »åº¦ç®¡ç†ã€ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯è²¯è“„ï¼‰
  - ã‚³ã‚¹ãƒˆå‰Šæ¸›: $21.6 â†’ $19.50è¦‹è¾¼ã¿ï¼ˆ10%å‰Šæ¸›ï¼‰
  - æœ€é©åŒ–æˆ¦ç•¥æ–‡æ›¸åŒ–ï¼ˆ`docs/OPTIMIZATION.md`ï¼‰
- **Phase 7.4 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™**: âœ… å®Œäº†
  - `docs/USAGE.md` (å…¨9ã‚»ã‚¯ã‚·ãƒ§ãƒ³) - è©³ç´°ãªä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰
  - `docs/API.md` (å®Œå…¨ãªAPIãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹)
  - `docs/OPTIMIZATION.md` (åŒ…æ‹¬çš„æœ€é©åŒ–æˆ¦ç•¥)

**Phase 8: CI/CDè¨­å®šï¼ˆå®Œäº† 3/3ï¼‰** âœ…
- GitHub Actionsè¨­å®š
- è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆ

**Phase 9: å®Ÿè£…å®Œæˆã¨ä¿®æ­£ï¼ˆå®Œäº† 26/26ï¼‰** âœ…
- Phase 9.1-9.7: å…¨æ©Ÿèƒ½å®Ÿè£…å®Œäº†
- Phase 9.8: ãƒ‡ãƒ¼ã‚¿å“è³ªæ”¹å–„ï¼ˆé£Ÿæ–™æ”¯å‡ºæ¯”ç‡ã€ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ã€æŠ•è³‡æŒ‡æ¨™ï¼‰
- Phase 9.9: employment_statuså‹ä¸ä¸€è‡´ãƒã‚°ä¿®æ­£ï¼ˆEnumçµ±ä¸€ï¼‰
  - **æ ¹æœ¬åŸå› **: JSONã®æ–‡å­—åˆ— "employed" ãŒEnumå‹ã«å¤‰æ›ã•ã‚Œã¦ã„ãªã‹ã£ãŸ
  - **è§£æ±ºç­–**: `HouseholdProfile.from_dict()` ä½¿ç”¨ã§Enumå¤‰æ›ã‚’å®Ÿè¡Œ
  - **çµæœ**: Step 0å¤±æ¥­ç‡ãŒ66.67% â†’ 33.33%ã«æ”¹å–„ âœ…
- Phase 9.10: é‡‘èå¸‚å ´ã¨é›‡ç”¨ã‚·ã‚¹ãƒ†ãƒ ã®æ”¹å–„
  - **Phase 9.10.1**: è²¸å‡ºå¯©æŸ»ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…
    - è²¸å‡ºé¡ä¸Šé™ãƒã‚§ãƒƒã‚¯ (max_loan_amount=1,000,000)
    - é è²¸ç‡ãƒã‚§ãƒƒã‚¯ (LTDâ‰¤90%)
    - rejected_loansã‚«ã‚¦ãƒ³ã‚¿ãƒ¼è¿½åŠ 
  - **Phase 9.10.2**: é›‡ç”¨ç›®æ¨™ã®å‹•çš„è¨ˆç®—å®Ÿè£…
    - å›ºå®š5äºº â†’ è³‡æœ¬è¦æ¨¡ãƒ™ãƒ¼ã‚¹è¨ˆç®— (ç›®æ¨™ = max(1, int(è³‡æœ¬/50,000)))
    - çµŒæ¸ˆçš„åˆç†æ€§ã‚’åæ˜ ï¼ˆè³‡æœ¬ãŒå¤§ãã„ä¼æ¥­ã»ã©å¤šãé›‡ç”¨ï¼‰
- Phase 9.11: ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº† âœ…
  - **ruffãƒã‚§ãƒƒã‚¯**: å…¨ãƒã‚§ãƒƒã‚¯é€šéï¼ˆ11ã‚¨ãƒ©ãƒ¼ â†’ 0ã‚¨ãƒ©ãƒ¼ï¼‰
  - **ä¿®æ­£å†…å®¹**:
    - firm.py: TYPE_CHECKINGå°å…¥ã§HouseholdAgentå¾ªç’°ã‚¤ãƒ³ãƒãƒ¼ãƒˆè§£æ±º
    - simulation.py: æœªä½¿ç”¨ãƒ«ãƒ¼ãƒ—å¤‰æ•°ã‚’_firm_idã«ãƒªãƒãƒ¼ãƒ 
    - test_phase9_integration.py: æœªä½¿ç”¨å¤‰æ•°å‰Šé™¤ã€zip()ã«strict=Falseè¿½åŠ 
  - **ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: 7ãƒ•ã‚¡ã‚¤ãƒ«å†ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã€46ãƒ•ã‚¡ã‚¤ãƒ«é©åˆæ¸ˆã¿
  - **çµæœ**: å…¨ãƒ•ã‚¡ã‚¤ãƒ«ruffæº–æ‹ ã€ã‚³ãƒ¼ãƒ‰å“è³ª100%é”æˆ

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ç†è§£

### 1. ä¸‰å±¤æ§‹é€ 

ã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®3ã¤ã®ã‚³ã‚¢ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§æ§‹æˆã•ã‚Œã¾ã™ï¼š

1. **Environmentï¼ˆç’°å¢ƒå±¤ï¼‰**
   - ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒƒãƒ—ï¼š1ã‚¹ãƒ†ãƒƒãƒ— = 1ãƒ¶æœˆ
   - 2ã¤ã®ãƒ•ã‚§ãƒ¼ã‚ºï¼šMove-in phaseï¼ˆäººå£å¢—åŠ ï¼‰ã€Development phaseï¼ˆå®šå¸¸çŠ¶æ…‹ï¼‰
   - 3ã¤ã®å¸‚å ´ï¼šè²¡å¸‚å ´ã€åŠ´åƒå¸‚å ´ã€é‡‘èå¸‚å ´

2. **Interaction Protocolï¼ˆç›¸äº’ä½œç”¨ãƒ—ãƒ­ãƒˆã‚³ãƒ«å±¤ï¼‰**
   - Function Callingæ–¹å¼ã§LLMã¨ã‚„ã‚Šå–ã‚Š
   - ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯JSONå½¢å¼ã§ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿”ã™
   - ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒæ¤œè¨¼å¾Œã«å®Ÿè¡Œ

3. **Agentsï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå±¤ï¼‰**
   - 4ã¤ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ï¼ˆè©³ç´°ã¯å¾Œè¿°ï¼‰

### 2. ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®è¨­è¨ˆ

#### 2.1 Householdï¼ˆä¸–å¸¯ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰
- **æ•°é‡**: 200ä¸–å¸¯ï¼ˆç•°è³ªãªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- **å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/agents/household.py`
- **å±æ€§**:
  - å¹´é½¢ã€æ•™è‚²ãƒ¬ãƒ™ãƒ«ã€æ¶ˆè²»å—œå¥½ã€ã‚¹ã‚­ãƒ«ä¿æœ‰
  - ç¾é‡‘ä¿æœ‰é‡ã€åŠ´åƒå‚åŠ çŠ¶æ³ã€ä½å±…
- **æ„æ€æ±ºå®š**:
  1. æ¶ˆè²»ãƒãƒ³ãƒ‰ãƒ«ï¼ˆå¿…éœ€å“ã¸ã®æœ€ä½æ”¯å‡ºï¼‰
  2. åŠ´åƒå¸‚å ´è¡Œå‹•ï¼ˆæ±‚è·ã€è¾è·ã€å¿œå‹Ÿï¼‰
  3. ä½å±…é¸æŠ
  4. é‡‘èæ„æ€æ±ºå®šï¼ˆè²¯è“„ã€å€Ÿå…¥ã€æŠ•è³‡ï¼‰

#### 2.2 Firmï¼ˆä¼æ¥­ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰
- **æ•°é‡**: è¤‡æ•°ï¼ˆ44ç¨®é¡ã®è²¡ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰å‹•çš„ç”Ÿæˆï¼‰
- **å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/agents/firm.py`
- **ç”Ÿç”£é–¢æ•°**: Cobb-Douglaså‹
  - `Y_i = A * L_i^(1-Î±) * K_i^Î±`
  - å®Ÿè£…: `src/models/economic_models.py:15-84`
- **æ„æ€æ±ºå®š**:
  1. ç”Ÿç”£é‡ã¨ä¾¡æ ¼è¨­å®š
  2. åŠ´åƒå¸‚å ´è¡Œå‹•ï¼ˆæ¡ç”¨ã€è§£é›‡ã€è³ƒé‡‘èª¿æ•´ï¼‰
  3. æŠ•è³‡åˆ¤æ–­ï¼ˆå€Ÿå…¥ã€è³‡æœ¬è³¼å…¥ï¼‰

#### 2.3 Governmentï¼ˆæ”¿åºœã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰
- **å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/agents/government.py`
- **å½¹å‰²**:
  - ãƒã‚¯ãƒ­çµŒæ¸ˆæŒ‡æ¨™ã®ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ï¼ˆGDPã€ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ã€å¤±æ¥­ç‡ã€ã‚¸ãƒ‹ä¿‚æ•°ï¼‰
  - ç¨åç®¡ç†ï¼ˆç´¯é€²èª²ç¨ã€VATï¼‰
  - ç¦ç¥‰æ”¿ç­–ï¼ˆUBIé…å¸ƒã€å…¬å…±ã‚µãƒ¼ãƒ“ã‚¹å»ºè¨­ï¼‰
- **ç¨åˆ¶**:
  - æ‰€å¾—ç¨ï¼ˆä¸–å¸¯ï¼‰ï¼šç´¯é€²èª²ç¨
  - å®Ÿè£…: `src/models/economic_models.py:87-145`

#### 2.4 Central Bankï¼ˆä¸­å¤®éŠ€è¡Œã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰
- **å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/agents/central_bank.py`
- **å½¹å‰²**: é‡‘èæ”¿ç­–ã®å®Ÿè¡Œ
- **é‡‘åˆ©è¨­å®š**: ä¿®æ­£Taylor rule
  - `rÌ‚ = max{r^n + Ï€^t + Î±(Ï€ - Ï€^t) + Î²(Y - Y^n), 0}`
  - å®Ÿè£…: `src/models/economic_models.py:149-218`
- **é‡‘åˆ©å¹³æ»‘åŒ–**:
  - `r_t = Ï * r_{t-1} + (1-Ï) * rÌ‚_t`ï¼ˆÏ = 0.8ï¼‰

### 3. å¸‚å ´ãƒ¡ã‚«ãƒ‹ã‚ºãƒ 

#### 3.1 åŠ´åƒå¸‚å ´ï¼ˆLaborMarketï¼‰
- **å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/environment/markets/labor_market.py`
- **ãƒãƒƒãƒãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **: ç¢ºç‡çš„ã‚¹ã‚­ãƒ«ãƒ™ãƒ¼ã‚¹ãƒãƒƒãƒãƒ³ã‚°
- **ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°**: 70% ã‚¹ã‚­ãƒ«é©åˆåº¦ + 30% è³ƒé‡‘é©åˆåº¦
- **ç¢ºç‡**: 0.7ï¼ˆè¨­å®šå¯èƒ½ï¼‰
- **ãƒ†ã‚¹ãƒˆ**: `tests/test_labor_market.py` 8ãƒ†ã‚¹ãƒˆ

#### 3.2 è²¡å¸‚å ´ï¼ˆGoodsMarketï¼‰
- **å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/environment/markets/goods_market.py`
- **è²¡ã®ç¨®é¡**: 44ç¨®é¡ï¼ˆ10ã‚«ãƒ†ã‚´ãƒªï¼‰
- **ãƒãƒƒãƒãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **: ä¾¡æ ¼ãƒ™ãƒ¼ã‚¹
- **æ©Ÿèƒ½**: éœ€çµ¦ãƒŸã‚¹ãƒãƒƒãƒè¿½è·¡ã€åœ¨åº«ç®¡ç†
- **ãƒ†ã‚¹ãƒˆ**: `tests/test_goods_market.py` 4ãƒ†ã‚¹ãƒˆ

#### 3.3 é‡‘èå¸‚å ´ï¼ˆFinancialMarketï¼‰
- **å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/environment/markets/financial_market.py`
- **é‡‘åˆ©æ§‹é€ **:
  - é é‡‘é‡‘åˆ© = æ”¿ç­–é‡‘åˆ© + deposit_spread (-0.01)
  - è²¸å‡ºé‡‘åˆ© = æ”¿ç­–é‡‘åˆ© + loan_spread (+0.02)
- **æ©Ÿèƒ½**: é é‡‘ãƒ»è²¸å‡ºå‡¦ç†ã€é è²¸ç‡è¿½è·¡
- **è²¸å‡ºå¯©æŸ»** (Phase 9.10.1):
  - è²¸å‡ºé¡ä¸Šé™ãƒã‚§ãƒƒã‚¯ (max_loan_amount=1,000,000)
  - é è²¸ç‡ãƒã‚§ãƒƒã‚¯ (ç·è²¸å‡º/ç·é é‡‘ â‰¤ 90%)
  - å¯©æŸ»æ‹’å¦ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ (rejected_loans)
- **ãƒ†ã‚¹ãƒˆ**: `tests/test_financial_market.py` 5ãƒ†ã‚¹ãƒˆ

### 4. å®Ÿè£…æ¸ˆã¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
SimCity/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ base_agent.py          # åŸºåº•ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚¯ãƒ©ã‚¹ (283è¡Œ)
â”‚   â”‚   â”œâ”€â”€ household.py           # ä¸–å¸¯ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ (501è¡Œ)
â”‚   â”‚   â”œâ”€â”€ firm.py                # ä¼æ¥­ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ (395è¡Œ)
â”‚   â”‚   â”œâ”€â”€ government.py          # æ”¿åºœã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ (301è¡Œ)
â”‚   â”‚   â””â”€â”€ central_bank.py        # ä¸­å¤®éŠ€è¡Œã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ (287è¡Œ)
â”‚   â”œâ”€â”€ environment/
â”‚   â”‚   â”œâ”€â”€ simulation.py          # ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³ (355è¡Œ)
â”‚   â”‚   â””â”€â”€ markets/
â”‚   â”‚       â”œâ”€â”€ labor_market.py    # åŠ´åƒå¸‚å ´ (297è¡Œ)
â”‚   â”‚       â”œâ”€â”€ goods_market.py    # è²¡å¸‚å ´ (261è¡Œ)
â”‚   â”‚       â””â”€â”€ financial_market.py # é‡‘èå¸‚å ´ (179è¡Œ)
â”‚   â”œâ”€â”€ llm/
â”‚   â”‚   â”œâ”€â”€ llm_interface.py       # LLM API ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (263è¡Œ)
â”‚   â”‚   â””â”€â”€ prompts/
â”‚   â”‚       â”œâ”€â”€ household_system.txt
â”‚   â”‚       â”œâ”€â”€ firm_system.txt
â”‚   â”‚       â”œâ”€â”€ government_system.txt
â”‚   â”‚       â””â”€â”€ central_bank_system.txt
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ data_models.py         # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« (361è¡Œ)
â”‚   â”‚   â””â”€â”€ economic_models.py     # çµŒæ¸ˆãƒ¢ãƒ‡ãƒ« (471è¡Œ)
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ skill_types.py         # 58ã‚¹ã‚­ãƒ«å®šç¾© (525è¡Œ)
â”‚   â”‚   â”œâ”€â”€ goods_types.py         # 44è²¡å®šç¾© (528è¡Œ)
â”‚   â”‚   â””â”€â”€ firm_templates.json    # 44ä¼æ¥­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ (598è¡Œ)
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ config.py              # è¨­å®šç®¡ç† (285è¡Œ)
â”‚   â”‚   â””â”€â”€ logger.py              # ãƒ­ã‚°ç®¡ç† (114è¡Œ)
â”‚   â””â”€â”€ visualization/             # Phase 4å®Œäº†
â”‚       â”œâ”€â”€ geography.py           # åœ°ç†ã‚·ã‚¹ãƒ†ãƒ  (332è¡Œ)
â”‚       â”œâ”€â”€ map_generator.py       # ãƒãƒƒãƒ—å¯è¦–åŒ– (348è¡Œ)
â”‚       â”œâ”€â”€ plots.py               # çµŒæ¸ˆã‚°ãƒ©ãƒ• (561è¡Œ)
â”‚       â””â”€â”€ dashboard.py           # Streamlitãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ (573è¡Œ)
â”œâ”€â”€ scripts/                       # å®Ÿé¨“å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆPhase 7å®Œäº†ï¼‰
â”‚   â”œâ”€â”€ run_baseline.py             # ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ (403è¡Œ)
â”‚   â”œâ”€â”€ run_shock_experiments.py    # å¤–ç”Ÿã‚·ãƒ§ãƒƒã‚¯å®Ÿé¨“ã‚¹ã‚¯ãƒªãƒ—ãƒˆ (507è¡Œ)
â”‚   â””â”€â”€ generate_initial_households.py  # åˆæœŸä¸–å¸¯ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ (155è¡Œ)
â”œâ”€â”€ data/                          # Phase 5ãƒ‡ãƒ¼ã‚¿
â”‚   â”œâ”€â”€ firm_templates/            # 44ä¼æ¥­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆ44ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
â”‚   â””â”€â”€ initial_households.json    # 200ä¸–å¸¯åˆæœŸãƒ‡ãƒ¼ã‚¿ (224.8 KB)
â”œâ”€â”€ experiments/                   # å®Ÿé¨“ãƒ»æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆPhase 6å®Œäº†ï¼‰
â”‚   â”œâ”€â”€ validation.py              # çµŒæ¸ˆç¾è±¡æ¤œè¨¼ (560è¡Œ)
â”‚   â””â”€â”€ robustness_test.py         # ãƒ­ãƒã‚¹ãƒˆãƒã‚¹ãƒ†ã‚¹ãƒˆ (440è¡Œ)
â”œâ”€â”€ docs/                          # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆPhase 7å®Œäº†ï¼‰
â”‚   â”œâ”€â”€ USAGE.md                   # è©³ç´°ãªä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰ (9ã‚»ã‚¯ã‚·ãƒ§ãƒ³)
â”‚   â”œâ”€â”€ API.md                     # å®Œå…¨ãªAPIãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹
â”‚   â””â”€â”€ OPTIMIZATION.md            # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–æˆ¦ç•¥
â”œâ”€â”€ tests/                         # 207ãƒ†ã‚¹ãƒˆã€100%æˆåŠŸã€ã‚«ãƒãƒ¬ãƒƒã‚¸86%
â”‚   â”œâ”€â”€ test_dashboard.py          # 4ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_economic_models.py    # 18ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_financial_market.py   # 5ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_geography.py          # 20ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_goods_market.py       # 4ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_household_agent.py    # 14ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_integration.py        # 15ãƒ†ã‚¹ãƒˆ (Phase 6.2)
â”‚   â”œâ”€â”€ test_labor_market.py       # 8ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_llm_integration.py    # 2ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_map_generator.py      # 14ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_performance.py        # 6ãƒ†ã‚¹ãƒˆ (Phase 6.1)
â”‚   â”œâ”€â”€ test_phase2_agents.py      # 27ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_phase5_data.py        # 14ãƒ†ã‚¹ãƒˆ (Phase 5)
â”‚   â”œâ”€â”€ test_phase9_integration.py # 18ãƒ†ã‚¹ãƒˆ (Phase 9)
â”‚   â”œâ”€â”€ test_plots.py              # 20ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ test_robustness.py         # 6ãƒ†ã‚¹ãƒˆ (Phase 6.4)
â”‚   â””â”€â”€ test_validation.py         # 12ãƒ†ã‚¹ãƒˆ (Phase 6.3)
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ simulation_config.yaml     # ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
â”‚   â””â”€â”€ llm_config.yaml            # LLMè¨­å®š
â”œâ”€â”€ pyproject.toml                 # uvç®¡ç†
â”œâ”€â”€ .env.example
â”œâ”€â”€ .gitignore
â”œâ”€â”€ LICENSE                        # Apache 2.0
â”œâ”€â”€ README.md
â”œâ”€â”€ CLAUDE.md                      # æœ¬ãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ TASKS.md                       # é€²æ—ç®¡ç†ï¼ˆ166/166å®Œäº†ã€100%ï¼‰
```

## ä¸»è¦æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### å¿…é ˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
- **LLMçµ±åˆ**: `openai` (1.59.7)
- **æ•°å€¤è¨ˆç®—**: `numpy` (2.2.1), `scipy` (1.15.1)
- **ãƒ‡ãƒ¼ã‚¿å‡¦ç†**: `pandas` (2.2.3)
- **è¨­å®šç®¡ç†**: `pyyaml` (6.0.2), `python-dotenv` (1.0.1), `pydantic` (2.10.5)
- **ãƒ­ã‚®ãƒ³ã‚°**: `loguru` (0.7.3)
- **ã‚³ãƒ¼ãƒ‰å“è³ª**: `ruff` (0.9.1)
- **ãƒ†ã‚¹ãƒˆ**: `pytest` (8.4.2), `pytest-cov` (7.0.0)
- **å¯è¦–åŒ–**: `streamlit`, `matplotlib`

### æœªå®Ÿè£…ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- **åˆ†æ**: `statsmodels`ï¼ˆçµŒæ¸ˆæŒ‡æ¨™ã®ç›¸é–¢åˆ†æï¼‰

## é‡è¦ãªå®Ÿè£…ã®è©³ç´°

### LLMçµ±åˆï¼ˆsrc/llm/llm_interface.pyï¼‰

```python
class LLMInterface:
    """
    OpenAI APIã¨ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

    æ©Ÿèƒ½:
    - Function Callingå®Ÿè£…
    - ã‚³ã‚¹ãƒˆè¿½è·¡
    - ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹ï¼ˆmax_retries=3ï¼‰
    - ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šï¼ˆ30ç§’ï¼‰
    """

    def call_with_functions(
        self,
        messages: list[dict],
        functions: list[dict],
        function_call: str | dict = "auto"
    ) -> dict:
        """Function Callingã‚’ä½¿ç”¨ã—ãŸLLMå‘¼ã³å‡ºã—"""
```

### ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹é€ 

å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ä»¥ä¸‹ã®æƒ…å ±ã‚’å—ã‘å–ã‚‹ï¼š

```
System Prompt:
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å½¹å‰²ã¨ç›®æ¨™
- å¿œç­”ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆJSONï¼‰

User Prompt:
### Profile
- å€‹åˆ¥å±æ€§æƒ…å ±

### Report
- éå»ã®è¡Œå‹•å±¥æ­´

### Observation
- ç’°å¢ƒã®çŠ¶æ…‹ï¼ˆå¸‚å ´ä¾¡æ ¼ã€å¤±æ¥­ç‡ç­‰ï¼‰

### Actions
- å®Ÿè¡Œå¯èƒ½ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ä¸€è¦§
```

### ãƒ‡ãƒ¼ã‚¿åˆæœŸåŒ–

#### ä¸–å¸¯ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆï¼ˆsrc/agents/household.py:343-398ï¼‰
- **æ‰€å¾—åˆ†å¸ƒ**: Lognormalåˆ†å¸ƒ
  - `ln(m_i,0) ~ N(Î¼=10.5, Ïƒ=0.5)`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šï¼‰
  - è«–æ–‡ç‰ˆ: Î¼=11.1496, ÏƒÂ²=1.1455ï¼ˆ2023 ACS IPUMS microdataã‹ã‚‰MLEæ¨å®šï¼‰
- **å¹´é½¢åˆ†å¸ƒ**: æ­£è¦åˆ†å¸ƒï¼ˆÎ¼=40, Ïƒ=12ï¼‰
- **ã‚¹ã‚­ãƒ«**: 58ç¨®é¡ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ å‰²ã‚Šå½“ã¦

#### ä¼æ¥­ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆsrc/data/firm_templates.jsonï¼‰
- **ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: OECD Input-Output Tablesï¼ˆè«–æ–‡è¨˜è¼‰ï¼‰
- **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ•°**: 44ç¨®é¡
- **å†…å®¹**: åˆæœŸè³‡æœ¬ã€TFPã€è³ƒé‡‘ã€ã‚¹ã‚­ãƒ«è¦ä»¶

## é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ

```bash
# å…¨ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
uv run pytest

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ã
uv run pytest --cov=src --cov-report=html

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
uv run pytest tests/test_labor_market.py -v
```

### ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯

```bash
# ruff ãƒã‚§ãƒƒã‚¯
uv run ruff check src/ tests/

# è‡ªå‹•ä¿®æ­£
uv run ruff check --fix src/ tests/

# ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé©ç”¨
uv run ruff format src/ tests/
```

### æ–°ã—ã„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®è¿½åŠ 

```python
from src.agents.base_agent import BaseAgent
from src.llm.llm_interface import LLMInterface

class CustomAgent(BaseAgent):
    """ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ"""

    def __init__(self, llm_interface: LLMInterface, ...):
        super().__init__(
            agent_id="custom_agent",
            agent_type="custom",
            llm_interface=llm_interface,
        )

    def decide_action(self, observation: dict) -> dict:
        """æ„æ€æ±ºå®šãƒ¡ã‚½ãƒƒãƒ‰"""
        # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
        messages = self._build_prompt(observation)

        # Functionå®šç¾©
        functions = [...]

        # LLMå‘¼ã³å‡ºã—
        response = self.llm_interface.call_with_functions(
            messages=messages,
            functions=functions
        )

        return response
```

### æ–°ã—ã„å¸‚å ´ã®è¿½åŠ 

```python
from dataclasses import dataclass
from loguru import logger

@dataclass
class MarketRequest:
    """å¸‚å ´ã¸ã®è¦æ±‚"""
    agent_id: int
    ...

class CustomMarket:
    """ã‚«ã‚¹ã‚¿ãƒ å¸‚å ´"""

    def __init__(self):
        self.total_transactions = 0
        logger.info("CustomMarket initialized")

    def match(self, requests: list[MarketRequest]) -> list:
        """ãƒãƒƒãƒãƒ³ã‚°å‡¦ç†"""
        transactions = []
        # ãƒãƒƒãƒãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯
        return transactions

    def get_statistics(self) -> dict:
        """çµ±è¨ˆæƒ…å ±å–å¾—"""
        return {
            "total_transactions": self.total_transactions,
            ...
        }
```

## æ¤œè¨¼æ–¹æ³•

### ãƒã‚¯ãƒ­çµŒæ¸ˆç¾è±¡ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼ˆPhase 6å®Ÿè£…äºˆå®šï¼‰
1. **Phillips Curve**: å¤±æ¥­ç‡ã¨ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ã®è² ã®ç›¸é–¢
2. **Okun's Law**: å¤±æ¥­ç‡å¤‰åŒ–ã¨GDPæˆé•·ç‡ã®è² ã®ç›¸é–¢
3. **Beveridge Curve**: æ±‚äººç‡ã¨å¤±æ¥­ç‡ã®è² ã®ç›¸é–¢
4. **Price Elasticity**: éœ€è¦ã®ä¾¡æ ¼å¼¾åŠ›æ€§ï¼ˆå¿…éœ€å“: -1<E<0ã€å¥¢ä¾ˆå“: E<-1ï¼‰
5. **Engel's Law**: æ‰€å¾—ä¸Šæ˜‡ã«ä¼´ã†é£Ÿè²»å‰²åˆã®æ¸›å°‘
6. **Investment Volatility**: æŠ•è³‡ > æ¶ˆè²»ã®ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£
7. **Price Stickiness**: ä¾¡æ ¼èª¿æ•´ã®é…å»¶

### ãƒ­ãƒã‚¹ãƒˆãƒã‚¹æ¤œè¨¼
- ç•°ãªã‚‹ä¹±æ•°ã‚·ãƒ¼ãƒ‰ã§3å›å®Ÿè¡Œ
- å®šæ€§çš„ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å†ç¾æ€§ã‚’ç¢ºèª

### å¤–ç”Ÿã‚·ãƒ§ãƒƒã‚¯å®Ÿé¨“
- 44è²¡ã®ã†ã¡7è²¡ã‚’ãƒ©ãƒ³ãƒ€ãƒ é¸æŠ
- Â±50%ã®ä¾¡æ ¼ã‚·ãƒ§ãƒƒã‚¯
- 6å¹´é–“ï¼ˆ72ã‚¹ãƒ†ãƒƒãƒ—ï¼‰ã®è¿½è·¡

## ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®šï¼ˆè«–æ–‡ã‚ˆã‚Šï¼‰

### ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
- ä¸–å¸¯æ•°: 200
- Phase 1: 36ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆ3å¹´ï¼‰
- Phase 2: 144ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆ12å¹´ã€48å››åŠæœŸï¼‰
- LLM: `gpt-4o-mini`ï¼ˆé€šå¸¸æ¨è«–ï¼‰ã€`gpt-4`ï¼ˆVLMï¼‰
- ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

### çµŒæ¸ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
- ç”Ÿç”£é–¢æ•°: Î±ï¼ˆè³‡æœ¬ã‚·ã‚§ã‚¢ï¼‰ã¯ä¼æ¥­ã”ã¨ã«è¨­å®š
- Taylor rule: Î±ï¼ˆã‚¤ãƒ³ãƒ•ãƒ¬å¿œç­”ï¼‰ã€Î²ï¼ˆç”£å‡ºã‚®ãƒ£ãƒƒãƒ—å¿œç­”ï¼‰
- é‡‘åˆ©å¹³æ»‘åŒ–: Ï = 0.8
- åˆæœŸä¾¡æ ¼: å…¨è²¡50ï¼ˆå…·ä½“å€¤ã¯å½±éŸ¿å°ï¼‰

## ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Š

è«–æ–‡Appendix Bã‚ˆã‚Šï¼š
- ç´„800,000ãƒˆãƒ¼ã‚¯ãƒ³/ã‚¹ãƒ†ãƒƒãƒ—
- gpt-4: ç´„$0.25/ã‚¹ãƒ†ãƒƒãƒ— â†’ 180ã‚¹ãƒ†ãƒƒãƒ—ã§ç´„$180
- gpt-4o-mini: ç´„$0.12/ã‚¹ãƒ†ãƒƒãƒ— â†’ 180ã‚¹ãƒ†ãƒƒãƒ—ã§ç´„$21.6
- æœ€é©åŒ–å¾Œ: $15-18/180ã‚¹ãƒ†ãƒƒãƒ—

## é‡è¦ãªè¨­è¨ˆä¸Šã®æ³¨æ„ç‚¹

1. **ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ•°ã®åˆ¶ç´„**
   - ä¸–å¸¯200ã¯è¨ˆç®—ã‚³ã‚¹ãƒˆã¨ã®ãƒãƒ©ãƒ³ã‚¹
   - ä¸¦åˆ—å‡¦ç†ã¯ç„¡åŠ¹åŒ–å¯èƒ½ï¼ˆè«–æ–‡è¨˜è¼‰ï¼‰

2. **æƒ…å ±ã‚¢ã‚¯ã‚»ã‚¹åˆ¶ç´„**
   - ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯å‰ã‚¹ãƒ†ãƒƒãƒ—ã®æƒ…å ±ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
   - åŒæ™‚æ„æ€æ±ºå®šã‚’é¿ã‘ã‚‹

3. **VLMã®å½¹å‰²**ï¼ˆPhase 4å®Ÿè£…äºˆå®šï¼‰
   - ä¼æ¥­é…ç½®æ±ºå®š
   - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãªã—ã§è‡ªç„¶ã«ã‚¯ãƒ©ã‚¹ã‚¿æ§‹é€ å½¢æˆ

4. **é‡‘èå¸‚å ´ã®ç°¡ç•¥åŒ–**
   - å‚µåˆ¸ã€æ ªå¼ã€ãƒ‡ãƒªãƒãƒ†ã‚£ãƒ–ã¯æœªå®Ÿè£…
   - æ•°ç†æœ€é©åŒ–ã¯ä½¿ç”¨ã›ãš

5. **ãƒ¡ãƒ¢ãƒªç®¡ç†**
   - æ§‹é€ åŒ–ãƒ¡ãƒ¢ãƒªã§ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä¿æŒ
   - é•·æœŸè¨˜æ†¶ã¨çŸ­æœŸè¨˜æ†¶ã®åˆ†é›¢

## è¿½åŠ è³‡æ–™

- è«–æ–‡å…¨æ–‡: `2510.01297v1.pdf`
- è«–æ–‡Markdownç‰ˆ: `2510.01297v1.md`
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹: è«–æ–‡Appendix Eï¼ˆListing 3-17ï¼‰
- ã‚¿ã‚¹ã‚¯ç®¡ç†: `TASKS.md`ï¼ˆè©³ç´°ãªé€²æ—è¿½è·¡ï¼‰

## é–‹ç™ºæ™‚ã®ç•™æ„äº‹é …

1. **å†ç¾æ€§**: ä¹±æ•°ã‚·ãƒ¼ãƒ‰ã®å›ºå®šã€LLMãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è¨˜éŒ²
2. **ãƒ­ã‚°**: å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ„æ€æ±ºå®šç†ç”±ã‚’ãƒ­ã‚°åŒ–ï¼ˆloguruä½¿ç”¨ï¼‰
3. **æ¤œè¨¼**: å„ã‚¹ãƒ†ãƒƒãƒ—ã§ãƒã‚¯ãƒ­çµŒæ¸ˆæŒ‡æ¨™ã‚’è¨ˆç®—ãƒ»è¨˜éŒ²
4. **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€å¸‚å ´ã€ç’°å¢ƒã‚’ç–çµåˆã«
5. **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**: ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰é¿ã‘ã€YAMLã§ç®¡ç†
6. **ãƒ†ã‚¹ãƒˆé§†å‹•**: æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã¯å¿…ãšãƒ†ã‚¹ãƒˆã‚’ä½œæˆ

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—æ¨å¥¨

### ğŸ¯ çµŒæ¸ˆç¾è±¡æ¤œè¨¼ï¼ˆæœ€çµ‚ã‚¹ãƒ†ãƒƒãƒ—ï¼‰

Phase 0-9ãŒå…¨ã¦å®Œäº†ã—ã¾ã—ãŸï¼æœ€çµ‚ã‚¹ãƒ†ãƒƒãƒ—ã¨ã—ã¦180ã‚¹ãƒ†ãƒƒãƒ—ãƒ†ã‚¹ãƒˆã§çµŒæ¸ˆç¾è±¡ã‚’æ¤œè¨¼ã—ã¾ã™ï¼š

#### æ¤œè¨¼é …ç›®ï¼ˆPhase 6å®Ÿè£…æ¸ˆã¿ï¼‰
1. **Phillips Curve**: å¤±æ¥­ç‡ã¨ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ã®è² ã®ç›¸é–¢
2. **Okun's Law**: å¤±æ¥­ç‡å¤‰åŒ–ã¨GDPæˆé•·ç‡ã®è² ã®ç›¸é–¢
3. **Beveridge Curve**: æ±‚äººç‡ã¨å¤±æ¥­ç‡ã®è² ã®ç›¸é–¢
4. **Price Elasticity**: éœ€è¦ã®ä¾¡æ ¼å¼¾åŠ›æ€§
5. **Engel's Law**: æ‰€å¾—ä¸Šæ˜‡ã«ä¼´ã†é£Ÿè²»å‰²åˆã®æ¸›å°‘
6. **Investment Volatility**: æŠ•è³‡>æ¶ˆè²»ã®ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£
7. **Price Stickiness**: ä¾¡æ ¼èª¿æ•´ã®é…å»¶

### å®Ÿé¨“å®Ÿè¡Œï¼ˆPhase 7ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½¿ç”¨ï¼‰
å®Ÿè£…æ¸ˆã¿ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦å®Ÿé¨“ã‚’å®Ÿè¡Œã§ãã¾ã™ï¼š

#### ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ
```bash
uv run python scripts/run_baseline.py --steps 180 --validate --visualize
```

#### ã‚·ãƒ§ãƒƒã‚¯å®Ÿé¨“
```bash
# ä¾¡æ ¼ã‚·ãƒ§ãƒƒã‚¯å®Ÿé¨“
uv run python scripts/run_shock_experiments.py --experiment price_shock --shock-step 50

# æ”¿ç­–ã‚·ãƒ§ãƒƒã‚¯å®Ÿé¨“
uv run python scripts/run_shock_experiments.py --experiment policy_shock --shock-step 50

# äººå£ã‚·ãƒ§ãƒƒã‚¯å®Ÿé¨“
uv run python scripts/run_shock_experiments.py --experiment population_shock --shock-step 50
```

è©³ç´°ã¯ `docs/USAGE.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
